<!DOCTYPE html>
<html>
<!-- refer  https://developer.mozilla.org/en-US/docs/Web/API/Geolocation/Using_geolocation -->
<!-- works in mozilla, will not work in chrome from local file, use a local webserver -->
<!-- run this from the directory containing the html to load python -m SimpleHTTPServer -->
<!-- access 127.0.0.1:8000 -->


<head>
<!-- import external javascript libraries using this format -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>
<!-- script tags below contain the javascript -->
<script type="text/javascript">

window.onload = function() {
    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(function(position) {
            alert('it works');
            console.log('it works');
        }, function(error) {
            alert('Error occurred. Error code: ' + error.code);
            console.log('Error occurred. Error code: ' + error.code);
            //chrome throws this error.
        },{timeout:5000});
    }else{
        alert('no geolocation support');
    }
};

function geoFindMe() {
  console.log("function geoFindMe called");
  var output = document.getElementById("out");

  if (!navigator.geolocation){
    output.innerHTML = "<p>Geolocation is not supported by your browser</p>";
    return;
  }

  if ("geolocation" in navigator) {
  	/* geolocation is available */
  	console.log("geolocation is available");
  	navigator.geolocation.getCurrentPosition(function(position) {
  		console.log("position.coords.latitude="+position.coords.latitude);
  		console.log("position.coords.longitude="+position.coords.longitude);
	});
	console.log("geolocation is available_2");
  } else {
  	/* geolocation IS NOT available */
  	console.log("geolocation IS NOT available");
  }


  function success(position) {
    var latitude  = position.coords.latitude;
    var longitude = position.coords.longitude;

    output.innerHTML = '<p>Latitude is ' + latitude + '<br>Longitude is ' + longitude + '</p>';

    var img = new Image();
    img.src = "https://maps.googleapis.com/maps/api/staticmap?center=" + latitude + "," + longitude + "&zoom=13&size=300x300&sensor=false";

    output.appendChild(img);
  };

  function error() {
    output.innerHTML = "Unable to retrieve your location";
  };

  output.innerHTML = "<p>Locatingâ€¦</p>";

  navigator.geolocation.getCurrentPosition(success, error);
}
</script>
<!-- style tags below contain css -->
<style>
body {
  padding: 20px;
  background-color:#ffffc9
}

p { margin : 0; }
</style>

</head>
<body>

<p>blah...</p>

<p><button onclick="geoFindMe()">Show my location</button></p>
<div id="out"></div>

</body>
</html>

